@model GameTracker.ViewModel.Games.CatalogViewModel
@{
    ViewData["Title"] = "Каталог игр";
}

<div class="mb-4">
    <form asp-action="Catalog" asp-controller="Catalog" method="get">
        <div class="input-group">
            <input name="search" class="form-control w-50" value="@ViewBag.Search" placeholder="Поиск" />
            <select name="sort" class="form-control w-auto" value="@ViewBag.Sort">
                @if (ViewBag.Sort == "Popular")
                {
                    <option value="Popular" selected>По популярности</option>
                }
                else
                {
                    <option value="Popular">По популярности</option>
                }
                @if (ViewBag.Sort == "Name")
                {
                    <option value="Name" selected>По названию</option>
                }
                else
                {
                    <option value="Name">По названию</option>
                }

                @if (ViewBag.Sort == "Year")
                {
                    <option value="Year" selected>По дате выхода(сначала новые)</option>
                }
                else
                {
                    <option value="Year">По дате выхода(сначала новые)</option>
                }

                @if (ViewBag.Sort == "YearRev")
                {
                    <option value="YearRev" selected>По дате выхода(сначала старые)</option>
                }
                else
                {
                    <option value="YearRev">По дате выхода(сначала старые)</option>
                }
            </select>
            <button class="btn btn-primary" type="submit">Поиск</button>
        </div>
        <p class="mt-2">Найдено игр: @Model.AllGamesQuantity</p>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
            @if (Model.Games.Count == 0)
            {
                <h2>Игр не найдено</h2>
            }
            @foreach (var game in Model.Games)
            {
                <div class="col">
                    <a asp-controller="Game" asp-action="Game" asp-route-gameId="@game.Id">
                        <div class="game_card card shadow-sm h-100">
                            <img src="@game.ImageUrl" class="card-img-top object-fit-contain img-fluid" style="max-height: 200px" alt="@game.Name" />
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">@game.Name</h5>
                                <p class="text-muted">(@game.Year)</p>
                            </div>
                        </div>
                    </a>
                </div>
            }
        </div>
    </form>
</div>

<div class="mt-3 flex-row">
    <p>Page</p>
    @for (int i = 1; i <= (Model.AllGamesQuantity / Model.GamesPerPage) + 1; i++)
    {
        if (i == ViewBag.Page)
        {
            <a asp-action="Catalog" asp-controller="Catalog" asp-route-page="@i" asp-route-search="@ViewBag.Search" asp-route-sort="@ViewBag.Sort" class="btn btn-primary mx-1 my-1">@i</a>
        }
        else
        {
            <a asp-action="Catalog" asp-controller="Catalog" asp-route-page="@i" asp-route-search="@ViewBag.Search" asp-route-sort="@ViewBag.Sort" class="btn btn-outline-primary mx-1 my-1">@i</a>
        }
    }
</div>

<a asp-action="CreateGameRequest" asp-controller="GameRequests">
    Нет нужной игры?
</a>
